<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lock/Key</title>

  <style>
    :root {
      --max-delay: 2.2s;
      /* slow, relaxed */
      --fade-duration: 1s;
      /* slow fade */
      --font: "Times New Roman", serif;
    }

    html,
    body {
      margin:0;
      overflow:hidden;
      font-family: var(--font);
    }

    .wrapper{
    transform: rotate(90deg);
    transform-origin:bottom left;
    
    position:absolute;
    top: -100vw;
    left: 0;
    
    height:100vw;
    width:100vh;

    overflow:auto;
}

.about {
  position: absolute;
  right: 50px;
}

.title {
  position: absolute;
  /* right: 50px; */
}

.shorter {
  width: 75%;
}
  </style>
</head>

<body>
  <main class="wrapper">
    <table>
  <tr>
    <th>[02]</th>
    <th class="title"><i>The Zipper Will Remain (fragments taken from book<sup>1</sup>),</i></th>
    <th class="about">[About]</th>
  </tr>
  <tr>
    <td></td>
    <td>August 8, 2025</td>
  </tr>
  <tr>
    <td></td>
    <td>After seeing a show by Ming Fay.</td>
  </tr>
    <tr>
    <td></td>
    <td>(Visitors come and go. Come and go. Photograph and go.)</td>
  </tr>
      <tr>
    <td></td>
    <td class="shorter">(These seams still hold space for the once full skin now withered, shrunken. It is a gentle
      inference that something was there that is no longer. This seam is full because this skin was full.)</td>
  </tr>
        <tr>
    <td></td>
    <td>I photograph each page with my phone, so as not to forget. I later painstakingly type out each line,
      letter by letter.</td>
  </tr>
</table>
  </main>

  <script>
    (function () {
      const MAX_DELAY = 2.2;     // slow reveal
      const DURATION = 1.2;     // slow fade
      const STAGGER_EXP = 0.8;   // soft randomization

      function wrapLetters(rootEl) {
        const walker = document.createTreeWalker(rootEl, NodeFilter.SHOW_TEXT);
        const textNodes = [];
        while (walker.nextNode()) textNodes.push(walker.currentNode);

        textNodes.forEach(txt => {
          const parent = txt.parentNode;
          const text = txt.nodeValue;

          const frag = document.createDocumentFragment();

          for (const ch of text) {
            if (ch === " ") {
              // KEEP NORMAL SPACE (this allows wrapping!)
              frag.appendChild(document.createTextNode(" "));
            } else {
              const span = document.createElement("span");
              span.className = "char";
              span.textContent = ch;
              frag.appendChild(span);
            }
          }

          parent.replaceChild(frag, txt);
        });
      }

      function randomDelay() {
        const r = Math.random();
        const biased = Math.pow(r, STAGGER_EXP);
        return biased * MAX_DELAY;
      }

      function init() {
        const paragraphs = document.querySelectorAll('main .test');
        paragraphs.forEach(p => wrapLetters(p));

        const chars = document.querySelectorAll('.char');

        chars.forEach((el, idx) => {
          const d = randomDelay() + (idx % 15) * 0.01; // mild index bias

          el.style.setProperty('--d', d.toFixed(3) + 's');
          el.style.setProperty('--fade-duration', DURATION + 's');

          void el.offsetHeight;
          el.classList.add('play');

          el.addEventListener('animationend', () => {
            el.style.opacity = '1';
          }, { once: true });
        });
      }

      document.addEventListener('DOMContentLoaded', init);
    })();

    // From http://stackoverflow.com/a/5365036/2065702
    const randomColor = "#" + ((1 << 24) * Math.random() | 0).toString(16);

    document.documentElement.style.setProperty('--main-bg-color', randomColor);
  </script>
</body>

</html>
